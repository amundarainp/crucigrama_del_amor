<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Crucigrama del amor üíñ</title>
    <meta
      name="description"
      content="P√°gina rom√°ntica con crucigrama acr√≥stico NOSOTROS, s√≠labas y foto fija."
    />
    <meta property="og:title" content="Crucigrama del amor üíñ" />
    <meta
      property="og:description"
      content="Un juego tierno para celebrar nuestro aniversario."
    />
    <meta name="theme-color" content="#e11d48" />
    <link
      rel="icon"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ctext y='50%' x='50%' dominant-baseline='middle' text-anchor='middle' font-size='52'%3E%F0%9F%92%96%3C/text%3E%3C/svg%3E"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="sticky-header">
      <div class="container header">
        <h1>Crucigrama del amor</h1>
        <p class="tagline">
          Un juego tierno para celebrar nuestro aniversario üíò
        </p>
      </div>
    </header>

    <div class="main-spacer"></div>
    <div style="margin-top: 10px; display: flex; gap: 10px; align-items: center">
      <button id="themeToggle" type="button" class="theme-btn" aria-pressed="false" aria-label="Cambiar tema">
        <span class="theme-icon" aria-hidden="true">üåô</span>
        <span class="theme-text">Modo oscuro</span>
      </button>
    </div>

    <main class="container">
      <section class="photo-section" aria-labelledby="photoTitle">
        <h2 id="photoTitle" class="sr-only">Nuestra foto</h2>
        <div class="photo-card">
          <div class="photo-frame">
            <img
              id="couplePhoto"
              alt="Nuestra foto juntos"
              src="./Subir/Portada.avif"
            />
          </div>
          <p class="photo-legend">
            <span aria-hidden="true">‚ùù</span>
            Primer salida juntos. Finde hermoso
            <span aria-hidden="true">‚ùû</span>
          </p>
        </div>
      </section>

      <section id="intro" aria-labelledby="intro-title">
        <h2 id="intro-title">Instructivo</h2>
        <p>
          Complet√° las palabras y, cuando termines, toc√°
          <strong>Verificar</strong>. Todo tiene que ver con <em>nosotros</em>.
          Al final, el acr√≥stico vertical dice <strong>NOSOTROS</strong>.
        </p>
        <div id="status" class="status" aria-live="polite"></div>
      </section>

      <section class="grid-wrap" aria-label="Crucigrama y pistas">
        <!-- S√≠labas + Toggle + Botones -->
        <aside class="syllables" aria-labelledby="syllTitle">
          <div class="syllables-header">
            <h2 id="syllTitle">S√≠labas</h2>
            <label class="toggle" title="Cambiar tama√±o de celdas">
              <input
                type="checkbox"
                id="sizeToggle"
                class="switch-input"
                aria-label="Modo compacto"
                aria-controls="crosswordGrid"
              />
              <span class="switch" aria-hidden="true"></span>
              <span class="label">Modo compacto</span>
            </label>
          </div>
          <div id="syllGrid" class="syll-grid" role="list"></div>
          <p class="syll-hint">
            Tip: clic en una s√≠laba la inserta desde la celda enfocada ‚Üí
          </p>
          <div class="controls" role="group" aria-label="Acciones r√°pidas">
            <button id="checkBtn">Verificar</button>
            <button id="clearBtn" class="secondary">Borrar</button>
            <button
              id="revealBtn"
              class="secondary"
              title="Revelar la pr√≥xima letra de la palabra activa"
            >
              Revelar letra
            </button>
            <button
              id="qrBtn"
              class="secondary"
              title="Mostrar c√≥digo QR del sitio"
            >
              QR del sitio
            </button>
          </div>
        </aside>

        <!-- Tablero -->
        <div>
          <div
            style="
              display: flex;
              align-items: center;
              justify-content: space-between;
              gap: 16px;
            "
          >
            <h2 id="gridTitle" style="margin: 0">Grilla del crucigrama</h2>
            <div class="grid-style" aria-label="Estilo de grilla">
              <label for="gridStyle">Estilo:</label>
              <select id="gridStyle" aria-controls="crosswordGrid">
                <option value="contrast">Contraste alto</option>
                <option value="clarin">
                  Modo Claringrilla (oculta vac√≠as)
                </option>
              </select>
            </div>
          </div>
          <div class="board" aria-labelledby="gridTitle">
            <div class="corner" aria-hidden="true"></div>
            <div id="colIndex" class="col-index" role="presentation"></div>
            <div id="rowIndex" class="row-index" role="presentation"></div>
            <div
              id="crosswordGrid"
              role="grid"
              aria-labelledby="gridTitle"
            ></div>
          </div>
        </div>

        <!-- Pistas -->
        <aside class="clues" aria-labelledby="cluesTitle">
          <h2 id="cluesTitle">Pistas</h2>
          <h3>Horizontales</h3>
          <ol id="acrossList"></ol>
        </aside>
      </section>

      <footer
        role="contentinfo"
        style="
          background: var(--accent);
          color: white;
          padding: 1.5rem 0;
          margin-top: 2rem;
          border-radius: 10px;
        "
      >
        <div style="max-width: 1200px; margin: 0 auto; padding: 0 1rem">
          <p style="margin-bottom: 0.5rem">
            <small
              >Creado con ‚ù§Ô∏è por
              <a
                href="https://amor-en-paginas.pages.dev/"
                style="color: #ffd700; font-weight: 700"
                >Amor en P√°ginas</a
              >
              ‚Äî
              <a
                href="https://amor-en-paginas.pages.dev/#paquetes"
                style="color: #ffd700; text-decoration: underline"
                >Paquete Premium</a
              ></small
            >
          </p>
          <p style="margin-bottom: 0; opacity: 0.8">
            <small
              >Entrega estimada: 10 d√≠as | Soporte extendido y actualizaciones
              incluidas</small
            >
          </p>
        </div>
      </footer>
    </main>

    <!-- Modal final (Share Card) -->
    <div
      id="finalModal"
      class="modal-backdrop"
      role="dialog"
      aria-modal="true"
      aria-labelledby="finalTitle"
    >
      <div class="modal">
        <h3 id="finalTitle">¬°Felicidades, amor!</h3>
        <p id="finalMsg">
          Completamos nuestro crucigrama del amor. Siempre
          <strong>NOSOTROS</strong> üíó
        </p>
        <div class="share-card-wrap">
          <canvas
            id="shareCanvas"
            width="1000"
            height="700"
            aria-label="Tarjeta para compartir"
          ></canvas>
        </div>
        <div class="controls" style="justify-content: center">
          <button id="downloadCard" class="secondary">Descargar tarjeta</button>
          <button id="shareCard">Compartir</button>
          <button id="closeModal" class="secondary">Cerrar</button>
        </div>
      </div>
    </div>

    <!-- Modal QR -->
    <div
      id="qrModal"
      class="modal-backdrop"
      role="dialog"
      aria-modal="true"
      aria-labelledby="qrTitle"
    >
      <div class="modal">
        <h3 id="qrTitle">Abr√≠ este juego desde tu celular</h3>
        <p style="margin-bottom: 10px">Escane√° el QR o compart√≠ el link</p>
        <div></div>
        <div
          id="qrContainer"
          style="display: grid; place-items: center; margin: 10px 0 8px"
        ></div>
        <div></div>
        <div class="controls" style="justify-content: center">
          <button id="copyUrl" class="secondary">Copiar URL</button>
          <button id="shareQr" class="secondary">Compartir QR</button>
          <button id="downloadQr" class="secondary">Descargar QR</button>
          <button id="closeQr" class="secondary">Cerrar</button>
        </div>
      </div>
    </div>

    <!-- Sonidos -->
    <audio id="sndType" src="assets/snd-type.mp3" preload="auto"></audio>
    <audio id="sndClick" src="assets/snd-click.mp3" preload="auto"></audio>
    <audio id="sndSuccess" src="assets/snd-success.mp3" preload="auto"></audio>

    <!-- Toasts -->
    <div
      id="toastHost"
      class="toast-host"
      aria-live="polite"
      aria-atomic="true"
    ></div>
    <div id="toastOverlay" aria-hidden="true"></div>

    <!-- Bot√≥n flotante Amor en P√°ginas -->
    <a
      href="https://amor-en-paginas.pages.dev/"
      class="amor-badge"
      aria-label="Amor en P√°ginas"
      target="_blank"
      rel="noopener"
    >
      <svg
        width="20"
        height="20"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"
          fill="currentColor"
        />
      </svg>
      <span>Amor en P√°ginas</span>
    </a>

    <script src="vendor/qrcode.min.js" defer></script>
    <script src="index.js" defer></script>

    <!-- === Tour embebido === -->
    <button class="tour-floating-trigger" onclick="startTourLove()">üé• Iniciar Tour Demo</button>
    <div class="tour-overlay" id="tourOverlayLove" onclick="endTourLove()"></div>
    <div class="tour-spotlight" id="tourSpotlightLove" aria-hidden="true"></div>
    <div class="tour-modal-love" id="tourModalLove" role="dialog" aria-modal="true"></div>
    <script>
      const tourStepsLove = [
        { id: 'header', target: '.sticky-header', icon: 'üè∑Ô∏è', title: 'Encabezado pegajoso', description: 'T√≠tulo de la experiencia y bajada rom√°ntica siempre visibles al hacer scroll.', benefit: { title: '‚ú® Claridad constante', text: 'El usuario nunca pierde el contexto del juego y su prop√≥sito.' }, position: 'center' },
        { id: 'foto', target: '.photo-section', icon: 'üì∑', title: 'Foto principal', description: 'Una imagen con marco y leyenda manuscrita que ambienta la historia.', benefit: { title: '‚ú® Emoci√≥n visual', text: 'Prepara el terreno afectivo antes de jugar.' }, position: 'center' },
        { id: 'intro', target: '#intro', icon: '‚ÑπÔ∏è', title: 'Instructivo', description: 'Explicaci√≥n breve: complet√° las palabras y verific√° el acr√≥stico NOSOTROS.', benefit: { title: '‚ú® Onboarding simple', text: 'Instrucciones claras para empezar sin fricci√≥n.' }, position: 'center' },
        { id: 'silabas', target: '.syllables', icon: 'üî°', title: 'S√≠labas y acciones r√°pidas', description: 'Tablero de s√≠labas con modo compacto y acciones como verificar, borrar y revelar letra.', benefit: { title: '‚ú® Usabilidad', text: 'Herramientas pensadas para avanzar y aprender jugando.' }, position: 'center' },
        { id: 'tablero', target: '.board', icon: 'üß©', title: 'Grilla del crucigrama', description: 'Celdas con √≠ndices, estilos alternativos y validaci√≥n visual de aciertos.', benefit: { title: '‚ú® Feedback inmediato', text: 'Refuerza el progreso y mejora la experiencia.' }, position: 'center' },
        { id: 'pistas', target: '.clues', icon: 'üß†', title: 'Pistas', description: 'Listado de pistas con chips y estados de correctas.', benefit: { title: '‚ú® Aprendizaje guiado', text: 'Descubr√≠ la palabra con ayuda justa.' }, position: 'center' },
        { id: 'qr', target: '#qrBtn', icon: 'üì±', title: 'QR para compartir', description: 'Gener√° un c√≥digo QR para abrir el juego en otro dispositivo o compartir el link.', benefit: { title: '‚ú® Viralidad org√°nica', text: 'Facilitamos compartir la experiencia con otros.' }, position: 'center' },
        { id: 'footer', target: 'footer', icon: 'üìã', title: 'Footer con credibilidad', description: 'Firma Amor en P√°ginas, paquete y tiempos de entrega.', benefit: { title: '‚ú® Confianza y transparencia', text: 'Claridad sobre autor√≠a y propuesta de valor.' }, position: 'center' },
        { id: 'final', target: 'body', icon: 'üåü', title: '¬°Infinitas Posibilidades! ', description: 'Este es solo un ejemplo de lo que podemos crear. Cada p√°gina se adapta a tu historia, tus fotos y tu estilo. Sea cual sea la ocasi√≥n ‚Äîun cumplea√±os, un aniversario, una boda, una despedida de soltera, un nacimiento, una graduaci√≥n, el d√≠a de la madre o del padre, San Valent√≠n, o cualquier momento especial‚Äî transformamos tus recuerdos en una experiencia web √∫nica, emotiva y compartible.', benefit: { title: '‚ú® Tu historia, tu dise√±o', text: 'No hay l√≠mites: solo tu imaginaci√≥n y nuestras ganas de hacer realidad el regalo digital perfecto. ¬øListo para empezar?' }, position: 'center' },
      ];

      let currentStepLove = 0;

      function startTourLove(){
        currentStepLove = 0;
        document.getElementById('tourOverlayLove').style.display='block';
        document.getElementById('tourSpotlightLove').style.display='block';
        document.getElementById('tourModalLove').style.display='block';
        const trig = document.querySelector('.tour-floating-trigger'); if(trig) trig.style.display='none';
        showStepLove();
      }
      function endTourLove(){
        document.getElementById('tourOverlayLove').style.display='none';
        document.getElementById('tourSpotlightLove').style.display='none';
        document.getElementById('tourModalLove').style.display='none';
        const trig = document.querySelector('.tour-floating-trigger'); if(trig) trig.style.display='inline-flex';
      }
      function showStepLove(){
        if(currentStepLove >= tourStepsLove.length){ endTourLove(); return; }
        const step = tourStepsLove[currentStepLove];
        const target = document.querySelector(step.target);
        if(target){ target.scrollIntoView({behavior:'smooth', block:'center'}); setTimeout(()=>positionSpotlightLove(target), 600); }
        renderModalLove(step); updateProgressDotsLove();
      }
      function positionSpotlightLove(el){
        const r = el.getBoundingClientRect();
        const s = document.getElementById('tourSpotlightLove');
        const pad=12; s.style.top = `${r.top + window.scrollY - pad}px`;
        s.style.left = `${r.left + window.scrollX - pad}px`;
        s.style.width = `${r.width + pad*2}px`; s.style.height = `${r.height + pad*2}px`;
      }
      function renderModalLove(step){
        const m = document.getElementById('tourModalLove');
        m.innerHTML = `
          <div style="text-align:center;font-size:3rem;margin-bottom:.6rem;">${step.icon}</div>
          <h2>${step.title}</h2>
          <p>${step.description}</p>
          ${step.benefit ? `<div class="tour-benefit-box"><h3>${step.benefit.title}</h3><p>${step.benefit.text}</p></div>` : ''}
          <div class="d-flex gap-3 justify-content-center align-items-center" style="display:flex;gap:12px;justify-content:center;align-items:center;">
            <button class="tour-btn-next" onclick="nextStepLove()">Siguiente</button>
            <button class="tour-btn-skip" onclick="endTourLove()">Saltar</button>
          </div>
          <div class="tour-progress-dots" id="progressDotsLove"></div>`;
        m.onmouseenter = null;
        m.onmouseleave = null;
      }
      function updateProgressDotsLove(){
        const c = document.getElementById('progressDotsLove'); if(!c) return;
        c.innerHTML = tourStepsLove.map((_,i)=>`<span class='${i===currentStepLove?"active":""}'></span>`).join('');
      }
      function nextStepLove(){ currentStepLove++; showStepLove(); }
    </script>
  </body>
</html>
